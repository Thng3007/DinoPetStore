@using DinoPetStore.EF;

@{
    ViewBag.Title = "Đơn đặt hàng -Dino Store";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<h2 style="padding-top:10px">ĐƠN ĐẶT HÀNG</h2>

<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary text-center">ĐƠN ĐẶT HÀNG</h6>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                <div class="col-sm-12 col-md-6"></div><div class="col-sm-12 col-md-6"><div id="dataTable_filter" class="dataTables_filter"></div></div><div class="row">
                    <div class="col-sm-12">
                        <table class="table table-bordered dataTable" id="datatable" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {

        getDH();
    });
    function getDH() {



        $.ajax({
            type: "GET",
            url: "/DonHang/getDH",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var tbl = $('#datatable').DataTable({
                    data: data,
                    searching: false,
                    stateSave: true,
                    "bDestroy": true,
                    columns: [
                        {
                            title: 'Phương Thức Thanh Toán',
                            data: "DATHANHTOAN",
                            "render": function (data, type, row) {
                                if (data == "0") {
                                    return `<label>Ship COD - thanh toán khi nhận hàng</label>`
                                };
                                if (data == "1") {
                                    return `<label>Chuyển Khoản</label>`
                                };
                            }
                        },
                            { title: 'Ngày Đặt', data: "NGAYDAT" },
                            { title: 'Ngày Giao', data: "NGAYGIAO" },
                            { title: 'Mã Khách Hàng', data: "MAKH" },
                            { title: 'Tên Khách Hàng', data: "HOTENKH" },
                            { title: 'Tổng Tiền', data: "TONGTIEN" },
                            {
                                title: "Chi Tiết",
                                data: null,
                                defaultContent: `<a href = "#"><i class="fa fa-edit" style = "color: blue;"></i></a>`,
                                className: 'row-edit dt-center'
                            },
                        ],

                    });

                    $('#datatable').on('click', 'tbody td.row-edit', function (e) {
                        var objData = tbl.row(this).data();
                        window.location.href = `/Admin/DonHang/ChiTietDonHang?Id=${objData.MADH}`;
                    });



            },
            failure: function (response) {
                alert(response)
                DevExpress.ui.notify(response, 3000);
            },
            error: function (response) {
                alert(response)
            }
        })
    }


</script>
